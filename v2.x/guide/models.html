<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Models | Laravel Orion</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="shortcut icon" href="/laravel-orion-docs/favicon.ico">
    <meta name="description" content="The simplest way to create REST API with Laravel">
    
    <link rel="preload" href="/laravel-orion-docs/assets/css/0.styles.24e631b1.css" as="style"><link rel="preload" href="/laravel-orion-docs/assets/js/app.1dca256b.js" as="script"><link rel="preload" href="/laravel-orion-docs/assets/js/2.6b13ee20.js" as="script"><link rel="preload" href="/laravel-orion-docs/assets/js/29.24c80911.js" as="script"><link rel="prefetch" href="/laravel-orion-docs/assets/js/10.1e17f041.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/11.1e78ed18.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/12.5aa791bd.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/13.8918454f.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/14.e64b3a95.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/15.58976b3e.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/16.92760101.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/17.ae75d769.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/18.78c9695f.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/19.5a379eda.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/20.24c9be5a.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/21.bac630e0.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/22.d2bef11d.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/23.8a94f1a9.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/24.0949b713.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/25.57f00407.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/26.498928c4.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/27.fc9adc48.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/28.50f29d94.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/3.72ba0fe6.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/30.5971d15d.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/31.506c95b5.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/32.e5b213d8.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/33.2cc74a99.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/34.27007d9d.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/35.cea1ac4b.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/36.376b6b06.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/37.66776aec.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/38.48333497.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/39.f2c8bf85.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/4.86b9a2f3.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/40.e17b15f0.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/41.4a3e5ac5.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/42.1f95a839.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/5.95f74c19.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/6.d1309ee9.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/7.a6a6263e.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/8.ff95c835.js"><link rel="prefetch" href="/laravel-orion-docs/assets/js/9.e6ae5fb7.js">
    <link rel="stylesheet" href="/laravel-orion-docs/assets/css/0.styles.24e631b1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/laravel-orion-docs/" class="home-link router-link-active"><!----> <span class="site-name">Laravel Orion</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/laravel-orion-docs/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/laravel-orion-docs/v2.x/guide/" class="nav-link router-link-active">
  Guide
</a></div><div class="nav-item"><a href="/laravel-orion-docs/screencasts/" class="nav-link">
  Screencasts
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Version" class="dropdown-title"><span class="title">Version</span> <span class="arrow down"></span></button> <button type="button" aria-label="Version" class="mobile-dropdown-title"><span class="title">Version</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/laravel-orion-docs/v1.x/guide/" class="nav-link">
  1.x
</a></li><li class="dropdown-item"><!----> <a href="/laravel-orion-docs/v2.x/guide/" class="nav-link router-link-active">
  2.x
</a></li></ul></div></div> <a href="https://github.com/tailflow/laravel-orion" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/laravel-orion-docs/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/laravel-orion-docs/v2.x/guide/" class="nav-link router-link-active">
  Guide
</a></div><div class="nav-item"><a href="/laravel-orion-docs/screencasts/" class="nav-link">
  Screencasts
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Version" class="dropdown-title"><span class="title">Version</span> <span class="arrow down"></span></button> <button type="button" aria-label="Version" class="mobile-dropdown-title"><span class="title">Version</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/laravel-orion-docs/v1.x/guide/" class="nav-link">
  1.x
</a></li><li class="dropdown-item"><!----> <a href="/laravel-orion-docs/v2.x/guide/" class="nav-link router-link-active">
  2.x
</a></li></ul></div></div> <a href="https://github.com/tailflow/laravel-orion" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Guide</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/laravel-orion-docs/v2.x/guide/prologue.html" class="sidebar-link">Prologue</a></li><li><a href="/laravel-orion-docs/v2.x/guide/" aria-current="page" class="sidebar-link">Introduction</a></li><li><a href="/laravel-orion-docs/v2.x/guide/getting-started.html" class="sidebar-link">Getting Started</a></li><li><a href="/laravel-orion-docs/v2.x/guide/models.html" aria-current="page" class="active sidebar-link">Models</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/laravel-orion-docs/v2.x/guide/models.html#setting-up-controller" class="sidebar-link">Setting up Controller</a></li><li class="sidebar-sub-header"><a href="/laravel-orion-docs/v2.x/guide/models.html#setting-up-routes" class="sidebar-link">Setting up Routes</a></li><li class="sidebar-sub-header"><a href="/laravel-orion-docs/v2.x/guide/models.html#customizing-keys" class="sidebar-link">Customizing Keys</a></li><li class="sidebar-sub-header"><a href="/laravel-orion-docs/v2.x/guide/models.html#customizing-queries" class="sidebar-link">Customizing Queries</a></li></ul></li><li><a href="/laravel-orion-docs/v2.x/guide/relationships.html" class="sidebar-link">Relationships</a></li><li><a href="/laravel-orion-docs/v2.x/guide/hooks.html" class="sidebar-link">Hooks</a></li><li><a href="/laravel-orion-docs/v2.x/guide/search.html" class="sidebar-link">Search</a></li><li><a href="/laravel-orion-docs/v2.x/guide/batch-operations.html" class="sidebar-link">Batch Operations</a></li><li><a href="/laravel-orion-docs/v2.x/guide/query-parameters.html" class="sidebar-link">Query Parameters</a></li><li><a href="/laravel-orion-docs/v2.x/guide/security.html" class="sidebar-link">Security</a></li><li><a href="/laravel-orion-docs/v2.x/guide/responses.html" class="sidebar-link">Responses</a></li><li><a href="/laravel-orion-docs/v2.x/guide/specifications.html" class="sidebar-link">Specifications</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>TypeScript SDK</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/laravel-orion-docs/v2.x/guide/typescript-sdk/introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/laravel-orion-docs/v2.x/guide/typescript-sdk/getting-started.html" class="sidebar-link">Getting Started</a></li><li><a href="/laravel-orion-docs/v2.x/guide/typescript-sdk/configuration.html" class="sidebar-link">Configuration</a></li><li><a href="/laravel-orion-docs/v2.x/guide/typescript-sdk/models.html" class="sidebar-link">Models</a></li><li><a href="/laravel-orion-docs/v2.x/guide/typescript-sdk/relationships.html" class="sidebar-link">Relationships</a></li><li><a href="/laravel-orion-docs/v2.x/guide/typescript-sdk/query-parameters.html" class="sidebar-link">Query Parameters</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="models"><a href="#models" class="header-anchor">#</a> Models</h1> <h2 id="setting-up-controller"><a href="#setting-up-controller" class="header-anchor">#</a> Setting up Controller</h2> <p>To expose a model through API, first you need to create a controller for it. As you may have seen in the <a href="/laravel-orion-docs/v2.x/guide/getting-started.html#simple-crud">Getting Started - Simple CRUD</a> section, defining a model controller is pretty straightforward.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Api</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Models<span class="token punctuation">\</span>Post</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Orion<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Controller</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">PostsController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Fully-qualified model class name
     */</span>
    <span class="token keyword">protected</span> <span class="token variable">$model</span> <span class="token operator">=</span> <span class="token class-name static-context">Post</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">;</span> <span class="token comment">// or &quot;App\Models\Post&quot;</span>
<span class="token punctuation">}</span>
</span></code></pre></div><h3 id="disabling-pagination"><a href="#disabling-pagination" class="header-anchor">#</a> Disabling pagination</h3> <p>By default, resources returned by the <code>index</code> endpoint are paginated. To disable the pagination and return all resources, you can use <code>DisablePagination</code> trait.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Api</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Models<span class="token punctuation">\</span>Post</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Orion<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Controller</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Orion<span class="token punctuation">\</span>Concerns<span class="token punctuation">\</span>DisablePagination</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">PostsController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span>
<span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token package">DisablePagination</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * Fully-qualified model class name
     */</span>
    <span class="token keyword">protected</span> <span class="token variable">$model</span> <span class="token operator">=</span> <span class="token class-name static-context">Post</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">;</span> <span class="token comment">// or &quot;App\Models\Post&quot;</span>
<span class="token punctuation">}</span>
</span></code></pre></div><div class="custom-block warning"><p class="custom-block-title">KEY TAKEAWAYS</p> <ul><li>Model controllers always extend <code>Orion\Http\Controllers\Controller</code></li> <li><code>$model</code> property is set to a fully qualified model class name</li> <li>Pagination can be disabled for both model and relation resources using <code>DisablePagination</code> trait</li></ul></div> <h2 id="setting-up-routes"><a href="#setting-up-routes" class="header-anchor">#</a> Setting up Routes</h2> <p>Once controller is created, it is the time to register routes.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Route</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Orion<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Orion</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>PostsController</span><span class="token punctuation">;</span>

<span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'as'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'api.'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token class-name static-context">Orion</span><span class="token operator">::</span><span class="token function">resource</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'posts'</span><span class="token punctuation">,</span> <span class="token class-name static-context">PostsController</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</span></code></pre></div><p>Essentially, <code>Orion::resource</code> method is the same as Laravel's default <code>Route::apiResource</code> - it will create multiple routes to handle a variety of actions on the resource.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>+--------+-----------+-------------------------------------------------+----------------------------------------+---------------------------------------------------------------------------+-------------------------------------------------+
<span class="token operator">|</span> Domain <span class="token operator">|</span> Method    <span class="token operator">|</span> URI                                             <span class="token operator">|</span> Name                                   <span class="token operator">|</span> Action                                                                    <span class="token operator">|</span> Middleware                                      <span class="token operator">|</span>
+--------+-----------+-------------------------------------------------+----------------------------------------+---------------------------------------------------------------------------+-------------------------------------------------+
<span class="token punctuation">..</span>.
<span class="token operator">|</span>        <span class="token operator">|</span> GET<span class="token operator">|</span>HEAD  <span class="token operator">|</span> api/posts                                       <span class="token operator">|</span> api.posts.index                        <span class="token operator">|</span> App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Api<span class="token punctuation">\</span>PostsController@index                            <span class="token operator">|</span> api                                             <span class="token operator">|</span>
<span class="token operator">|</span>        <span class="token operator">|</span> POST      <span class="token operator">|</span> api/posts/search                                <span class="token operator">|</span> api.posts.search                       <span class="token operator">|</span> App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Api<span class="token punctuation">\</span>PostsController@index                            <span class="token operator">|</span> api                                             <span class="token operator">|</span>
<span class="token operator">|</span>        <span class="token operator">|</span> POST      <span class="token operator">|</span> api/posts                                       <span class="token operator">|</span> api.posts.store                        <span class="token operator">|</span> App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Api<span class="token punctuation">\</span>PostsController@store                            <span class="token operator">|</span> api                                             <span class="token operator">|</span>
<span class="token operator">|</span>        <span class="token operator">|</span> GET<span class="token operator">|</span>HEAD  <span class="token operator">|</span> api/posts/<span class="token punctuation">{</span>post<span class="token punctuation">}</span>                                <span class="token operator">|</span> api.posts.show                         <span class="token operator">|</span> App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Api<span class="token punctuation">\</span>PostsController@show                             <span class="token operator">|</span> api                                             <span class="token operator">|</span>  
<span class="token operator">|</span>        <span class="token operator">|</span> PUT<span class="token operator">|</span>PATCH <span class="token operator">|</span> api/posts/<span class="token punctuation">{</span>post<span class="token punctuation">}</span>                                <span class="token operator">|</span> api.posts.update                       <span class="token operator">|</span> App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Api<span class="token punctuation">\</span>PostsController@update                           <span class="token operator">|</span> api                                             <span class="token operator">|</span>
<span class="token operator">|</span>        <span class="token operator">|</span> DELETE    <span class="token operator">|</span> api/posts/<span class="token punctuation">{</span>post<span class="token punctuation">}</span>                                <span class="token operator">|</span> api.posts.destroy                      <span class="token operator">|</span> App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Api<span class="token punctuation">\</span>PostsController@destroy                          <span class="token operator">|</span> api                                             <span class="token operator">|</span>
<span class="token operator">|</span>        <span class="token operator">|</span> POST      <span class="token operator">|</span> api/posts/batch                                 <span class="token operator">|</span> api.posts.batchStore                   <span class="token operator">|</span> App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Api<span class="token punctuation">\</span>PostsController@batchStore                       <span class="token operator">|</span> api                                             <span class="token operator">|</span>
<span class="token operator">|</span>        <span class="token operator">|</span> PATCH     <span class="token operator">|</span> api/posts/batch                                 <span class="token operator">|</span> api.posts.batchUpdate                  <span class="token operator">|</span> App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Api<span class="token punctuation">\</span>PostsController@batchUpdate                      <span class="token operator">|</span> api                                             <span class="token operator">|</span>
<span class="token operator">|</span>        <span class="token operator">|</span> DELETE    <span class="token operator">|</span> api/posts/batch                                 <span class="token operator">|</span> api.posts.batchDestroy                 <span class="token operator">|</span> App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Api<span class="token punctuation">\</span>PostsController@batchDestroy                     <span class="token operator">|</span> api                                             <span class="token operator">|</span>
</code></pre></div><h3 id="soft-deletes"><a href="#soft-deletes" class="header-anchor">#</a> Soft deletes</h3> <p>If your model uses <code>SoftDeletes</code> trait and you would like to expose the same functionality via API, call <code>withSoftDeletes</code> method upon resource registration.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Route</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Orion<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Orion</span><span class="token punctuation">;</span>

<span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'as'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'api.'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token class-name static-context">Orion</span><span class="token operator">::</span><span class="token function">resource</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'posts'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'Api\PostsController'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">withSoftDeletes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</span></code></pre></div><p>This will introduce <code>restore</code> and <code>batchRestore</code> endpoints. To learn how to permanently delete a resource via API (force delete), take a look at the related <a href="/laravel-orion-docs/v2.x/guide/query-parameters.html#soft-deletes">Query Parameters</a> section.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>+--------+-----------+-------------------------------------------------+----------------------------------------+---------------------------------------------------------------------------+-------------------------------------------------+
<span class="token operator">|</span> Domain <span class="token operator">|</span> Method    <span class="token operator">|</span> URI                                             <span class="token operator">|</span> Name                                   <span class="token operator">|</span> Action                                                                    <span class="token operator">|</span> Middleware                                      <span class="token operator">|</span>
+--------+-----------+-------------------------------------------------+----------------------------------------+---------------------------------------------------------------------------+-------------------------------------------------+
<span class="token punctuation">..</span>.
<span class="token operator">|</span>        <span class="token operator">|</span> POST      <span class="token operator">|</span> api/posts/<span class="token punctuation">{</span>post<span class="token punctuation">}</span>/restore                        <span class="token operator">|</span> api.posts.restore                      <span class="token operator">|</span> App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Api<span class="token punctuation">\</span>PostsController@restore                          <span class="token operator">|</span> api                                             <span class="token operator">|</span>
<span class="token operator">|</span>        <span class="token operator">|</span> POST      <span class="token operator">|</span> api/posts/batch/restore                         <span class="token operator">|</span> api.posts.batchRestore                 <span class="token operator">|</span> App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Api<span class="token punctuation">\</span>PostsController@batchRestore                     <span class="token operator">|</span> api                                             <span class="token operator">|</span>
</code></pre></div><h2 id="customizing-keys"><a href="#customizing-keys" class="header-anchor">#</a> Customizing Keys</h2> <p>By default, endpoints use primary key (usually <code>id</code>) to retrieve models from the database. However, in some cases you would want to use a different field to fetch the models while maintaining the primary key as it is. To do that, override the <code>keyName</code> method on the controller:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Api</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Models<span class="token punctuation">\</span>Post</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Orion<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Controller</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">PostsController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Fully-qualified model class name
     */</span>
    <span class="token keyword">protected</span> <span class="token variable">$model</span> <span class="token operator">=</span> <span class="token class-name static-context">Post</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">;</span> <span class="token comment">// or &quot;App\Models\Post&quot;</span>

    <span class="token comment">/**
     * The name of the field used to fetch a resource from the database.
     *
     * @return string
     */</span>
    <span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function-definition function">keyName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string single-quoted-string">'slug'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><h2 id="customizing-queries"><a href="#customizing-queries" class="header-anchor">#</a> Customizing Queries</h2> <p>Laravel Orion is quite flexible and allows you to redefine how Eloquent queries are build and run for each endpoint.</p> <h3 id="for-individual-endpoints"><a href="#for-individual-endpoints" class="header-anchor">#</a> For individual endpoints</h3> <h4 id="building-queries"><a href="#building-queries" class="header-anchor">#</a> Building queries</h4> <p>Let's say you would like the <code>index</code> endpoint to return only published blog posts. To do so, override the <code>buildIndexFetchQuery</code> method on the controller:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Api</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Models<span class="token punctuation">\</span>Post</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Orion<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Controller</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">PostsController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Fully-qualified model class name
     */</span>
    <span class="token keyword">protected</span> <span class="token variable">$model</span> <span class="token operator">=</span> <span class="token class-name static-context">Post</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">;</span> <span class="token comment">// or &quot;App\Models\Post&quot;</span>

    <span class="token comment">/**
     * Builds Eloquent query for fetching entities in index method.
     *
     * @param Request $request
     * @param array $requestedRelations
     * @return Builder
     */</span>
    <span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function-definition function">buildIndexFetchQuery</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token keyword type-hint">array</span> <span class="token variable">$requestedRelations</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token class-name return-type">Builder</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token keyword static-context">parent</span><span class="token operator">::</span><span class="token function">buildIndexFetchQuery</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token variable">$requestedRelations</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token variable">$query</span><span class="token operator">-&gt;</span><span class="token function">whereNotNull</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'published_at'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token variable">$query</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><h4 id="running-queries"><a href="#running-queries" class="header-anchor">#</a> Running queries</h4> <p>A common example is selecting only specific columns when fetching a list of models. To do so, override the <code>runIndexFetchQuery</code> method:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Api</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Models<span class="token punctuation">\</span>Post</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Orion<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Controller</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">PostsController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Fully-qualified model class name
     */</span>
    <span class="token keyword">protected</span> <span class="token variable">$model</span> <span class="token operator">=</span> <span class="token class-name static-context">Post</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">;</span> <span class="token comment">// or &quot;App\Models\Post&quot;</span>

    <span class="token operator">...</span>

    <span class="token comment">/**
     * Runs the given query for fetching entities in index method.
     *
     * @param Request $request
     * @param Builder $query
     * @param int $paginationLimit
     * @return LengthAwarePaginator
     */</span>
    <span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function-definition function">runIndexFetchQuery</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token class-name type-declaration">Builder</span> <span class="token variable">$query</span><span class="token punctuation">,</span> <span class="token keyword type-hint">int</span> <span class="token variable">$paginationLimit</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token class-name return-type">LengthAwarePaginator</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$query</span><span class="token operator">-&gt;</span><span class="token function">paginate</span><span class="token punctuation">(</span><span class="token variable">$paginationLimit</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'title'</span> <span class="token string single-quoted-string">'published_at'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><h4 id="performing-operations"><a href="#performing-operations" class="header-anchor">#</a> Performing operations</h4> <p>The main purpose of endpoints like <code>index</code> or <code>show</code> is to retrieve data from the database, not change it. But endpoints like <code>store</code>, <code>update,</code> etc. make changes to the database. It is also possible to customize how certain operations, like storing a model, are performed.</p> <p>In the given example we would force fill the attributes on the post, if the currenthly authenticated user is admin (roles implementation here is imaginary):</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Api</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Models<span class="token punctuation">\</span>Post</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Orion<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Controller</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">PostsController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Fully-qualified model class name
     */</span>
    <span class="token keyword">protected</span> <span class="token variable">$model</span> <span class="token operator">=</span> <span class="token class-name static-context">Post</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">;</span> <span class="token comment">// or &quot;App\Models\Post&quot;</span>

    <span class="token operator">...</span>

    <span class="token comment">/**
     * Fills attributes on the given entity and stores it in database.
     *
     * @param Request $request
     * @param Model $entity
     * @param array $attributes
     */</span>
    <span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function-definition function">performStore</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token class-name type-declaration">Model</span> <span class="token variable">$entity</span><span class="token punctuation">,</span> <span class="token keyword type-hint">array</span> <span class="token variable">$attributes</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">void</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">resolveUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">hasRole</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$entity</span><span class="token operator">-&gt;</span><span class="token function">forceFill</span><span class="token punctuation">(</span><span class="token variable">$attributes</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token variable">$entity</span><span class="token operator">-&gt;</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token variable">$attributes</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token variable">$entity</span><span class="token operator">-&gt;</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>You can also customize how attributes are filled on the model by overriding <code>performFill</code> method.</p></div> <h3 id="for-a-group-of-endpoints"><a href="#for-a-group-of-endpoints" class="header-anchor">#</a> For a group of endpoints</h3> <p>Cool, now index endpoint returns only published posts. But what if you would like to apply the same constraint to <code>show</code> endpoint as well? Sure enough, we could duplicate it and override the <code>buildShowFetchQuery</code> method, but there is a better way.</p> <h4 id="building-queries-2"><a href="#building-queries-2" class="header-anchor">#</a> Building queries</h4> <p>If you take a look at how <code>buildIndexFetchQuery</code> method is implemented, you will notice that it uses <code>buildFetchQuery</code> method. In fact, this method is used by <code>index</code>, <code>show</code>, <code>update</code>, <code>destroy</code>, and <code>restore</code> endpoints to build the query for fetching model(s), and you can override it as well!</p> <p>Here is how it would look like, if you would like to apply the same constraint to <code>index</code> and <code>show</code> endpoints (and <code>update</code>, <code>destroy</code>, and <code>restore</code>) at once:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Api</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Models<span class="token punctuation">\</span>Post</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Orion<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Controller</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">PostsController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Fully-qualified model class name
     */</span>
    <span class="token keyword">protected</span> <span class="token variable">$model</span> <span class="token operator">=</span> <span class="token class-name static-context">Post</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">;</span> <span class="token comment">// or &quot;App\Models\Post&quot;</span>

    <span class="token comment">/**
     * Builds Eloquent query for fetching entity(-ies).
     *
     * @param Request $request
     * @param array $requestedRelations
     * @return Builder
     */</span>
    <span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function-definition function">buildFetchQuery</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token keyword type-hint">array</span> <span class="token variable">$requestedRelations</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token class-name return-type">Builder</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token keyword static-context">parent</span><span class="token operator">::</span><span class="token function">buildFetchQuery</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token variable">$requestedRelations</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token variable">$query</span><span class="token operator">-&gt;</span><span class="token function">whereNotNull</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'published_at'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token variable">$query</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token operator">...</span>
<span class="token punctuation">}</span>
</span></code></pre></div><h4 id="running-queries-2"><a href="#running-queries-2" class="header-anchor">#</a> Running queries</h4> <p>While <code>index</code> endpoint is sort of an exception when it comes to running queries (since we fetch a list of models, not a single model), <code>show</code>, <code>update</code>, <code>destroy</code>, and <code>restore</code> endpoints share the same logic and use <code>runFetchQuery</code> under the hood.</p> <p>With a bit of refactor we get the controller where only published blog posts are fetched and only <code>id</code>, <code>title</code>, and <code>published_at</code> columns (attributes) are retrieved from the database.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Api</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Models<span class="token punctuation">\</span>Post</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Orion<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Controller</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">PostsController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Fully-qualified model class name
     */</span>
    <span class="token keyword">protected</span> <span class="token variable">$model</span> <span class="token operator">=</span> <span class="token class-name static-context">Post</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">;</span> <span class="token comment">// or &quot;App\Models\Post&quot;</span>

    <span class="token comment">/**
     * The list of attributes to select from db
     */</span>
    <span class="token keyword">protected</span> <span class="token variable">$attributes</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'title'</span> <span class="token string single-quoted-string">'published_at'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * Builds Eloquent query for fetching entity(-ies).
     *
     * @param Request $request
     * @param array $requestedRelations
     * @return Builder
     */</span>
    <span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function-definition function">buildFetchQuery</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token keyword type-hint">array</span> <span class="token variable">$requestedRelations</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token class-name return-type">Builder</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token keyword static-context">parent</span><span class="token operator">::</span><span class="token function">buildFetchQuery</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token variable">$requestedRelations</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token variable">$query</span><span class="token operator">-&gt;</span><span class="token function">whereNotNull</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'published_at'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token variable">$query</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Runs the given query for fetching entity.
     *
     * @param Request $request
     * @param Builder $query
     * @param int|string $key
     * @return Model
     */</span>
    <span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function-definition function">runFetchQuery</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token class-name type-declaration">Builder</span> <span class="token variable">$query</span><span class="token punctuation">,</span> <span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token class-name return-type">Model</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$query</span><span class="token operator">-&gt;</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">attributes</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">findOrFail</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Runs the given query for fetching entities in index method.
     *
     * @param Request $request
     * @param Builder $query
     * @param int $paginationLimit
     * @return LengthAwarePaginator
     */</span>
    <span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function-definition function">runIndexFetchQuery</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token class-name type-declaration">Builder</span> <span class="token variable">$query</span><span class="token punctuation">,</span> <span class="token keyword type-hint">int</span> <span class="token variable">$paginationLimit</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token class-name return-type">LengthAwarePaginator</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$query</span><span class="token operator">-&gt;</span><span class="token function">paginate</span><span class="token punctuation">(</span><span class="token variable">$paginationLimit</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">attributes</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Fills attributes on the given entity and stores it in database.
     *
     * @param Request $request
     * @param Model $post
     * @param array $attributes
     */</span>
    <span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function-definition function">performStore</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token class-name type-declaration">Model</span> <span class="token variable">$post</span><span class="token punctuation">,</span> <span class="token keyword type-hint">array</span> <span class="token variable">$attributes</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">void</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">resolveUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">hasRole</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$post</span><span class="token operator">-&gt;</span><span class="token function">forceFill</span><span class="token punctuation">(</span><span class="token variable">$attributes</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token variable">$post</span><span class="token operator">-&gt;</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token variable">$attributes</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token variable">$post</span><span class="token operator">-&gt;</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><h3 id="standard-operations-methods"><a href="#standard-operations-methods" class="header-anchor">#</a> Standard operations methods</h3> <table><thead><tr><th>Method</th> <th>Build</th> <th>Run</th> <th>Perform</th></tr></thead> <tbody><tr><td>index</td> <td>buildIndexFetchQuery</td> <td>runIndexFetchQuery</td> <td>-</td></tr> <tr><td>store</td> <td>-</td> <td>-</td> <td>performStore</td></tr> <tr><td>show</td> <td>buildShowFetchQuery</td> <td>runShowFetchQuery</td> <td>-</td></tr> <tr><td>update</td> <td>buildUpdateFetchQuery</td> <td>runUpdateFetchQuery</td> <td>performUpdate</td></tr> <tr><td>destroy</td> <td>buildDestroyFetchQuery</td> <td>runDestroyFetchQuery</td> <td>performDestroy</td></tr> <tr><td>restore</td> <td>buildRestoreFetchQuery</td> <td>runRestoreFetchQuery</td> <td>performRestore</td></tr></tbody></table></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/tailflow/laravel-orion-docs/edit/master/docs/v2.x/guide/models.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">7/28/2022, 9:10:28 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      
      <a href="/laravel-orion-docs/v2.x/guide/getting-started.html" class="prev">
        Getting Started
      </a></span> <span class="next"><a href="/laravel-orion-docs/v2.x/guide/relationships.html">
        Relationships
      </a>
      
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/laravel-orion-docs/assets/js/app.1dca256b.js" defer></script><script src="/laravel-orion-docs/assets/js/2.6b13ee20.js" defer></script><script src="/laravel-orion-docs/assets/js/29.24c80911.js" defer></script>
  </body>
</html>
